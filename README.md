# hanghae99-nodejs-lv2  
항해99 node.js 심화반 lv.2 과제입니다.  
</br></br>

## 필수 과제
### 1. 프레임워크와 라이브러리의 차이점  
**프레임워크**란 소프트웨어의 특정 문제를 해결하기 위해서는 상호 협력하는 클래스와 인터페이스의 집합으로 뼈대나 기반구조를 뜻하는데, Application 개발 시 필수적인 코드, 알고리즘, 데이터베이스 연동 등과 같은 가능들을 위해 어느정도 뼈대(구조)를 제공해주는 것입니다.  
**라이브러리**는 단순 활용가능한 도구들의 집합을 말합니다. 즉, 개발자가 개발하는데 필요한 것들은 모아둔 것입니다. 

라이브러리와 프레임워크의 차이는 제어 흐름에 대한 주도성이 누구에게/어디에 있는가에 있습니다. 즉, Application의 Flow(흐름)을 누가 쥐고 있느냐에 달려있습니다. </br>
* 프레임워크는 전체적인 흐름을 스스로가 쥐고 있으며, 사용자가 그 안에서 필요한 코드를 짜 넣습니다.  </br>
* 라이브러리는 사용자가 전체적인 흐름을 만들며, 라이브러리를 가져다 쓰는 것이라고 할 수 있습니다.  
</br></br>

### 2. Restful
* **Restful**이란?  </br>
REST의 6가지 규칙을 잘 지켜서 설계된 API를 RESTful API라고 합니다.  </br>
RESTful한 API를 구현하는 근본적인 목적이 성능 향상에 있는 것이 아니라 일관적인 컨벤션을 통한 API의 이해도 및 호환성을 높이는 것이 주 동기이기 때문에 성능이 중요한 상황에서는 RESTful한 API를 구현할 필요는 없습니다.  
</br>

* RESTful 설계 시 주의사항
    1. URL은 정보의 자원을 표현해야 합니다. (리소스명은 동사가 아닌 명사를 사용합니다.)
    2. 자원의 행위는 HTTP 메소드(GET, POST, PUT, DELETE)로 표현합니다.
    3. 슬래시(/)는 계층 관계를 나타낼 때 사용합니다.
    4. 소문자를 사용합니다.
    5. 밑줄(_)은 사용하지 않고 하이픈(-)을 사용합니다.
    6. 확장자(txt, png 등)을 사용하지 않습니다.
    7. URL 마지막에 슬래시(/)를 포함하지 않습니다.  
 </br></br>

**장점** 
  * Easy to use  
    REST API 메시지를 읽는 것 만으로도 메시지가 의도하는 바를 명확하게 파악할 수 있습니다.  
  * Complete Seperation Between Client and Sever  
    서버와 클라이언트를 완전히 독립적으로 구현할 수 있습니다.  
  * Detail Expression for Specific Data Type  </br></br>

**단점**  
  * Restriction of HTTP Method  
    행위에 대한 메소드가 제한적입니다.  
  * Absence Of Standard  
    표준이 존재하지 않습니다. 니는 관리의 어려움과 좋은 API 디자인 가이드가 존재하지 않음을 의미합니다.  
</br>
    
* RESTful의 대안은?  
대표적으로 SOAP이 있습니다. SOAP은 그 자체로 프로토콜이며, 보안이나 메시지 전송 등에 있어서 REST보다 더 많은 표준들이 정해져 있어 많은 리소스와 엄격한 보안, 다양한 요구 사항들을 만족해야 하는 경우에 SOAP 방식을 채택해서 사용합니다. 
</br></br>


### 3. node.js
* 비동기 처리를 위해 무엇을 했나요?  
자바스크립트와 노드에서는 비동기 처리는 콜백(callback) 함수로 해결 가능합니다. 이 때 함수의 매개 변수로 넘겨지는 콜백 함수가 반복되어 코드의 들여쓰기 수준이 감당하기 힘들 정도로 깊어지는 현상을 콜백 지옥(Callback Hell)이라 합니다. 콜백 지옥 현상을 극복하기 위해 프로미스(promise)가 등장하였지만 여전히 코드가 장황합니다. 그래서 async/await 문법을 통해 프로미스를 사용한 코드를 깔끔하게 줄여주었습니다.  

</br></br>

## API 서버 요구 사항
#### 1. 회원 가입 페이지
    - 닉네임은 최소 3자 이상, 알파벳 대소문자(a~z, A~Z), 숫자(0~9)로 구성하기
    - 비밀번호는 최소 4자 이상이며, 닉네임과 같은 값이 포함된 경우 회원가입에 실패로 만들기
    - 비밀번호 확인은 비밀번호와 정확하게 일치하기

#### 2. 로그인 페이지
    - 로그인 버튼을 누른 경우 닉네임과 비밀번호가 데이터베이스에 등록됐는지 확인한 뒤, 하나라도 맞지 않는 정보가 있다면 "닉네임 또는 패스워드를 확인해주세요"라는 메세지를 프론트엔드에서 띄워줄 수 있도록 예외처리 하기

#### 3. 로그인 검사
    - 로그인 하지 않은 사용자도, 게시글 목록 조회는 가능하도록 하기
    - 로그인하지 않은 사용자가 좋아요 버튼을 눌렀을 경우, "로그인이 필요합니다." 라는 메세지를 프론트엔드에서 띄워줄 수 있도록 예외처리 하기
    - 로그인 한 사용자가 로그인 페이지 또는 회원가입 페이지에 접속한 경우 "이미 로그인이 되어있습니다."라는 메세지로 예외처리하기
    - 로그인을 한 사용자만 글쓰기 권한이 존재함
    
#### 4. 예외 처리상황과 Http Method에 맞는 Http Status Code 반환하기
    - 본인이 선택한 Status Code의 반환 이유를 설명하기
    - 회원 가입 페이지, 로그인 페이지, 로그인 검사 기능
    
#### 5. CORS 해결하기
    - CORS란 무엇이며, 어떤 상황에서 일어나는지 / 어떻게 해결하는지 알아보고, 프로젝트에 적용하기
    
#### 6. 관리자 권한
    - 권한을 추가하여 관리자 계정 로그인 시 모든 게시글, 댓글을 삭제할 수 있도록 구현하기
</br></br>

## Response Example
* register
``` javascript
{
    "result": {
        "id": 1,
        "nickname": "stopss",
        "email": "stopss@email.com",
        "admin": true
  }
}
```
* login
```javascript
{
    "result": {
        "success": true,
        "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTY1NTQ2OTA5N30.CweQNpj8Msi1frCd-M-PApa9Q6JyVC2MM_2d29ZATbU"
    }
}
```

* post
```javascript
{
    "result": {
        "post_list": [
            {
                "postId": 5,
                "title": "범죄도시2",
                "content": "범죄도시2 보셨나요?",
                "image": "movieposter1655380276576.jpg",
                "userId": 1,
                "layout": "right",
                "createdAt": "2022-06-16T11:51:16.000Z",
                "updatedAt": "2022-06-16T11:51:16.000Z"
            }
        ]
    }
}
```

</br></br>

## Trouble Shooting
이미지 파일의 이름을 데이터베이스에 저장하는 과정에서 문제가 발생했다. console.log를 이용하여 req.file.filename의 값이 존재하는 걸 확인했지만 데이터베이스의 유효성 검사에서 실패하였다.
-> AllowNull: true로 변경한 후에 데이터베이스에 삽입이 가능해 졌다.
<img width="390" alt="image" src="https://user-images.githubusercontent.com/33679560/174434263-596b5dfc-25fe-4731-89ff-076aad9d00dc.png">





















